<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-dark.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <title>NanoBLASTer by ruhulsbu</title>
  </head>

  <body>
    <div id="container">
      <div class="inner">

        <header>
          <h1>NanoBLASTer</h1>
          <h2>Basic Local Alignment and Search Tool for Oxford Nanopore Long Sequences</h2>
        </header>

        <section id="downloads" class="clearfix">
          <a href="https://github.com/ruhulsbu/NanoBLASTer/zipball/master" id="download-zip" class="button"><span>Download .zip</span></a>
          <a href="https://github.com/ruhulsbu/NanoBLASTer/tarball/master" id="download-tar-gz" class="button"><span>Download .tar.gz</span></a>
          <a href="https://github.com/ruhulsbu/NanoBLASTer" id="view-on-github" class="button"><span>View on GitHub</span></a>
        </section>

        <hr>

        <section id="main_content">
          <h3>
<a id="nanoblaster-basic-local-alignment-and-search-tool-for-oxford-nanopore-long-sequences" class="anchor" href="#nanoblaster-basic-local-alignment-and-search-tool-for-oxford-nanopore-long-sequences" aria-hidden="true"><span class="octicon octicon-link"></span></a>NanoBLASTer: Basic Local Alignment and Search Tool for Oxford Nanopore Long Sequences</h3>

<p><strong><strong>Current Version: 0.16</strong></strong><br>
Release Date: October 13, 2015<br>
Platform: Linux x64 system</p>

<h3>
<a id="background" class="anchor" href="#background" aria-hidden="true"><span class="octicon octicon-link"></span></a>Background</h3>

<p>Oxford Nanopore's new MinION instrument is a handheld single-molecule DNA sequencer using nanopore-technology to produce long reads. However, the quality of the reads has been, to date, lower than other technologies, causing great interest to develop new algorithms that can make use of the data. So far, alignment methods including LAST, BLAST, BWA-MEM and GraphMap have been used to analyze these sequences. However, each of these tools has signicant challenges to use with these data: LAST and BLAST require considerable processing time for high sensitivity, BWA-MEM has the smallest average alignment length, and GraphMap aligns many random strings with moderate accuracy. </p>

<h3>
<a id="results" class="anchor" href="#results" aria-hidden="true"><span class="octicon octicon-link"></span></a>Results</h3>

<p>To address these challenges we developed a new read aligner called NanoBLASTer specically designed for long nanopore reads. In experiments resequencing the well-studied S. cerevisiae (yeast) and Escherichia coli (E. coli) genomes, we show that our algorithm produces longer alignments with higher overall sensitivity than LAST, BLAST and BWA-MEM. We also show that the runtime of NanoBLASTer is faster than GraphMap, BLAST and BWA-MEM. Finally, we show that NanoBLASTer is the most specific of the aligners.</p>

<h3>
<a id="conclusion" class="anchor" href="#conclusion" aria-hidden="true"><span class="octicon octicon-link"></span></a>Conclusion</h3>

<p>Using our improved aligner, we characterize the accuracy of nanopore reads, and present our insights into the biases and applications of the new sequencing technology.</p>

<h3>
<a id="methods" class="anchor" href="#methods" aria-hidden="true"><span class="octicon octicon-link"></span></a>Methods</h3>

<p>NanoBLASTer uses fixed size exact matching seeds followed by DP-based extension. However, because of the high error rate of the nanopore sequencing instruments (approximately 10% to 40% base error rate), the seeds that must be used are extremely short and provide relatively little specificity. NanoBLASTer overcomes this challenge and improves the specificity of short seeds by clustering neighboring seeds into mapping regions, and then identifying highly similar segment that we call ANCHORs from the clustered seeds. Extending the top scoring candidate ANCHORs with a block-wise banded sequence alignment algorithm generates the alignments. NanoBLASTer aligns long noisy reads using the following steps:</p>

<ul>
<li>Create an inverted K-mer index of the reference genome</li>
<li>Identify and cluster neighboring K-mers seeds</li>
<li>Identify and score the candidate ANCHOR</li>
<li>Extend the ANCHOR into a complete alignment</li>
<li>Report the alignments of sufficient quality in SAM format</li>
</ul>

<p><strong>Nanopore sequencing data</strong>: <a href="http://schatzlab.cshl.edu/data/nanocorr/">Oxford Nanopore Data for Reference and Reads</a></p>

<h3>
<a id="installation" class="anchor" href="#installation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Installation</h3>

<p>Please follow the following steps to install NanoBLASTer from source:</p>

<pre><code>Clone NanoBLASTer source code: git clone https://github.com/ruhulsbu/NanoBLASTer.git
Go to the NanoBLASTer source directory: cd NanoBLASTer/nano_src 
Build the NanoBLASTer project: make
</code></pre>

<h3>
<a id="input-specifications" class="anchor" href="#input-specifications" aria-hidden="true"><span class="octicon octicon-link"></span></a>Input specifications</h3>

<pre><code>Use the following options to run NanoBLASTer:
-C: To specify one of the Parameters: -C10, -C25, or -C50
-r: To specify the name of Reference file (FASTA format)
-i: To specify the name of Reads file (FASTA format)
-o: To specify the prefix of Output file
-k: To specify the size of KMER
-a: To specify the size of ANCHOR
-l: To specify the min number of Clusters
-s: To run the program at higher sensitivity
-n: To specify the Number of reads to be aligned
-h, or -?: To print this Help information.
</code></pre>

<h3>
<a id="usage-examples" class="anchor" href="#usage-examples" aria-hidden="true"><span class="octicon octicon-link"></span></a>Usage examples</h3>

<pre><code>Run NanoBLASTer in ``fast'' mode (KMER=13, ANCHOR=45 and CLUSTERS=10):
$ ./nanoblaster -C10 -r path/to/reference.fa -i path/to/reads.fa -o output

Run NanoBLASTer in ``sensitive'' mode (KMER=11, ANCHOR=40 and CLUSTERS=25):
$ ./nanoblaster -C25 -r path/to/reference.fa -i path/to/reads.fa -o output

Run NanoBLASTer in ``highly sensitive'' mode (KMER=11, ANCHOR=40, CLUSTERS=50 and SENSITIVITY=TRUE):
$ ./nanoblaster -C50 -r path/to/reference.fa -i path/to/reads.fa -o output

Run NanoBLASTer with default KMER=11, ANCHOR=40 and CLUSTERS=10:
$ ./nanoblaster -r path/to/reference.fa -i path/to/reads.fa -o output

Run NanoBLASTer with KMER=13, ANCHOR=45 and CLUSTERS=25 using default parameters at higher sensitivity:
$ ./nanoblaster -r path/to/reference.fa -i path/to/reads.fa -o output -k13 -a45 -l25 -s
</code></pre>

<ul>
<li>It is not recommended to use any additional parameters except input and output with C10, C25 or C50. But if we want to force additional parameters then we can add them after mentioning one of these sensitivity modes.</li>
</ul>

<h3>
<a id="optimize-configurations" class="anchor" href="#optimize-configurations" aria-hidden="true"><span class="octicon octicon-link"></span></a>Optimize configurations</h3>

<p>Edit the configurations in constant.h file to optimize NanoBLASTer alignment manually. Editing the following constants will have an overall impact on the alignment quality of NanoBLASTer:</p>

<ul>
<li>To increase/decrease the gap penalty change the constant "GAP" (positive number, default 6)</li>
<li>To increase/decrease the gap open penalty change the constant "GAP_OPEN" (additional penalty, default 2)</li>
<li>To increase/decrease the base mismatch weight change the constant "MISMATCH" (negative number, default -4)</li>
<li>To increase/decrease the base matching weight change the constant "WEIGHT" (positive number, default 5)</li>
<li>To change the percentage of identity match for sequence alignment change the constant "KBAND_PERCENT_MATCH" (default 55)</li>
<li>To change the size of read length considered for alignment change "MIN_READ_LEN" (default 100), or "MAX_READ_LEN" (default 200,000)</li>
<li>If the genome is circular the constant "CIRCULAR" must be 0<br>
</li>
</ul>

<p>Editing the following constants will have an impact on the sensitivity and runtime of NanoBLASTer. These constants have been defined with the default values for NanoBLASTer. Some of these default values have been optimized for "fast", "sensitive" and "highly sensitive" mode. So these three configured modes will not be affected even if the following constants are edited. It is recommended to define -k, -a and -l when the following constants are changed manually:</p>

<ul>
<li>To increase/decrease the seed tuple distance in a cluster change the constant SEED_TUPLE_DIST</li>
<li>To increase/decrease the primary anchor word size change the constant PRIM_ANCHOR_WORD</li>
<li>To increase/decrease the secondary anchor word size change the constant SECND_ANCHOR_WORD</li>
<li>To increase/decrease the primary anchor percent of identity change the constant PRIM_ANCHOR_PIDENT </li>
<li>To increase/decrease the secondary anchor percent of identity change the constant SECND_ANCHOR_PIDENT</li>
<li>To increase/decrease the size of block for banded sequence alignment change the constant FRAGMENT_SIZE</li>
</ul>

<p>Finally, define -k, -a and -l while running the ./nanoblaster executable with these changed constants to get the expected performance.</p>

<p>Currently, the sensitivity modes (C10, C25 and C25) are defined to align data set with very low accuracy (~65%). If the accuracy of the data set is ~75% then we need to modify the KMER and/or ANCHOR size when mentioning the sensitivity mode to get better runtime performance.  </p>

<h3>
<a id="contact-information" class="anchor" href="#contact-information" aria-hidden="true"><span class="octicon octicon-link"></span></a>Contact information</h3>

<p>Please send your comments or bug reports to <a href="mailto:moamin@cs.stonybrook.edu">moamin@cs.stonybrook.edu</a> </p>
        </section>

        <footer>
          NanoBLASTer is maintained by <a href="https://github.com/ruhulsbu">ruhulsbu</a><br>
          This page was generated by <a href="https://pages.github.com">GitHub Pages</a>. Tactile theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.
        </footer>

                  <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-65164000-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

      </div>
    </div>
  </body>
</html>
