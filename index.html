<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="NanoBLASTer : Basic Local Alignment and Search Tool for Oxford Nanopore Long Sequences">

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>NanoBLASTer</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/ruhulsbu/NanoBLASTer">View on GitHub</a>

          <h1 id="project_title">NanoBLASTer</h1>
          <h2 id="project_tagline">Basic Local Alignment and Search Tool for Oxford Nanopore Long Sequences</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/ruhulsbu/NanoBLASTer/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/ruhulsbu/NanoBLASTer/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h3>
<a id="nanoblaster-basic-local-alignment-and-search-tool-for-oxford-nanopore-long-sequences" class="anchor" href="#nanoblaster-basic-local-alignment-and-search-tool-for-oxford-nanopore-long-sequences" aria-hidden="true"><span class="octicon octicon-link"></span></a>NanoBLASTer: Basic Local Alignment and Search Tool for Oxford Nanopore Long Sequences</h3>

<p><strong><strong>Current Version: 0.16</strong></strong><br>
Release date: July 15, 2015<br>
Platform: Linux x64 system</p>

<h3>
<a id="introduction" class="anchor" href="#introduction" aria-hidden="true"><span class="octicon octicon-link"></span></a>Introduction</h3>

<p>The quality of the Oxford Nanopore MinION sequenced DNA reads has been considered as the limiting factor for the success of nanopore sequencing technology. Thus, it has been of great interest to the researchers to build software tools that can analyze the long noisy reads at higher sensitivity. So far, the existing alignment methods like LAST and BLAST have been used to analyze these sequences, but these tools are unable to produce long alignments for noisy reads, and take too much processing time at higher sensitivity. To address these issues, we introduce a novel alignment tool, NanoBLASTer for the long noisy nanopore reads. This tool produces long alignments of the noisy nanopore reads at higher sensitivity. The run time of NanoBLASTer remains feasible even as we increase the sensitivity of the tool. </p>

<h3>
<a id="methods" class="anchor" href="#methods" aria-hidden="true"><span class="octicon octicon-link"></span></a>Methods</h3>

<p>NanoBLASTer uses fixed size exact matching seeds followed by DP-based extension. However, because of the high error rate of the nanopore sequencing instruments (approximately 10% to 50% base error rate), the seeds that must be used are extremely short and provide relatively little specificity. NanoBLASTer overcomes this challenge and improves the specificity of short seeds by clustering neighboring seeds into mapping regions, and then identifying highly similar segment that we call ANCHORs from the clustered seeds. Extending the top scoring candidate ANCHORs with a block-wise banded sequence alignment algorithm generates the alignments. NanoBLASTer aligns long noisy reads using the following steps:</p>

<ul>
<li>Create an inverted K-mer index of the reference genome</li>
<li>Identify and cluster neighboring K-mers seeds</li>
<li>Identify and score the candidate ANCHOR</li>
<li>Extend the ANCHOR into a complete alignment</li>
<li>Report the alignments of sufficient quality in SAM format</li>
</ul>

<h3>
<a id="results" class="anchor" href="#results" aria-hidden="true"><span class="octicon octicon-link"></span></a>Results</h3>

<ul>
<li>Aligning nanopore reads accurately has proven difficult because of the high base error rates. To mitigate the problem,
we present a novel long noisy read aligner, NanoBLASTer, custom designed for MinION sequenced reads. This tool can
align noisy reads at higher sensitivity. In our experiments of aligning noisy yeast reads sequenced with MinION, we found
that NanoBLASTer can generate alignments that are more than one kilobase (~15%) longer on average than LAST.</li>
<li>The run-time performance of NanoBLASTer does not degrade as we increase the sensitivity of the tool. This is not true in
case of LAST or BLAST. In our experiment, we have run LAST and NanoBLASTer in their most sensitive configuration to align
the reads of yeast sequenced using MinION. NanoBLASTer runs at least 13 times faster than LAST (in most sensitive
configuration).</li>
<li>Concerns have been raised about the base-level accuracy of nanopore sequences, but quantifying its performance is difficult in the absence of a sensitive alignment program. To shed insights into the accuracy of the sequencer, we analyzed several characteristics of noisy sequences. For a particular yeast data set, we show that approximately 25% of the sequences align with an average alignment length of 6.45kbp at 62.3% accuracy providing an average coverage depth of 11.72. We also show that, for the long reads (&gt; 40kb), on average half of their length can be aligned. Thus the long reads of MinION can be used to span repetitive elements of sequences to provide highly contiguous assemblies.</li>
</ul>

<p><strong>Preprint</strong>: <a href="">NanoBLASTer: Fast Alignment and Characterization of Oxford Nanopore Single Molecule Sequence Reads</a>  </p>

<p><strong>Nanopore sequencing data</strong>: <a href="http://schatzlab.cshl.edu/data/nanocorr/">S. cerevisae W303 - Oxford Nanopore Data for Reference and Reads</a>  </p>

<h3>
<a id="installation" class="anchor" href="#installation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Installation</h3>

<p>Please follow the following steps to install NanoBLASTer from source:</p>

<pre><code>Download NanoBLASTer source code: wget https://github.com/ruhulsbu/LongReadAlignment/archive/master.zip
Unzip NanoBLASTer project: unzip master.zip
Go to the NanoBLASTer directory: cd Project_directory 
Build the NanoBLASTer project: make
</code></pre>

<h3>
<a id="input-specifications" class="anchor" href="#input-specifications" aria-hidden="true"><span class="octicon octicon-link"></span></a>Input specifications</h3>

<pre><code>Use the following options to run NanoBLASTer:
-C: To specify one of the Parameters: -C10, -C25, or -C50
-r: To specify the name of Reference file
-i: To specify the name of Reads file
-o: To specify the name of Output file
-k: To specify the size of KMER
-a: To specify the size of ANCHOR
-d: To specify SEED_TUPLE_DIST; &lt;=0 for max dist
-x: To specify the MAX_READ_LEN for alignment
-l: To specify the min number of Clusters
-s: To run the program in high sensitive mode
-n: To specify the Number of reads to be aligned
-h, or -?: To print this Help information.
</code></pre>

<h3>
<a id="usage-examples" class="anchor" href="#usage-examples" aria-hidden="true"><span class="octicon octicon-link"></span></a>Usage examples</h3>

<pre><code>Run NanoBLASTer in ``fast'' mode (KMER=13, ANCHOR=45 and CLUSTERS=10):
$ nanoblaster -C10 -r path/to/reference.fa -i path/to/reads.fa -o output

Run NanoBLASTer in ``sensitive'' mode (KMER=11, ANCHOR=40 and CLUSTERS=25):
$ nanoblaster -C25 -r path/to/reference.fa -i path/to/reads.fa -o output

Run NanoBLASTer in ``highly sensitive'' mode (KMER=11, ANCHOR=40, CLUSTERS=50 and SENSITIVITY=TRUE):
$ nanoblaster -C50 -r path/to/reference.fa -i path/to/reads.fa -o output

Run NanoBLASTer with default KMER=11, ANCHOR=40 and CLUSTERS=10:
$ nanoblaster -r path/to/reference.fa -i path/to/reads.fa -o output
</code></pre>

<h3>
<a id="optimize-configurations" class="anchor" href="#optimize-configurations" aria-hidden="true"><span class="octicon octicon-link"></span></a>Optimize configurations</h3>

<p>Edit the configurations in constant.h file to optimize NanoBLASTer alignment manually. Editing the following constants will have an overall impact on the alignment quality of NanoBLASTer:</p>

<ul>
<li>To increase/decrease the gap penalty change the constant "GAP" (positive number)</li>
<li>To increase/decrease the gap open penalty change the constant "GAP_OPEN"</li>
<li>To increase/decrease the base mismatch weight change the constant "MISMATCH" (negative number)</li>
<li>To increase/decrease the base matching weight change the constant "WEIGHT"</li>
<li>To increase/decrease the match/mismatch open reward/penalty change the constant "MAT_OPEN"</li>
<li>To change the percentage of identity match for sequence alignment change the constant "KBAND_PERCENT_MATCH"</li>
<li>To change the size of read length considered for alignment change "MIN_READ_LEN", or "MAX_READ_LEN"</li>
<li>If the genome is circular the constant "CIRCULAR" must be 0<br>
</li>
</ul>

<p>Editing the following constants will have an impact on the sensitivity and runtime of NanoBLASTer. These constants have been defined with the default value for NanoBLASTer. Some of these default values have been optimized for "fast", "sensitive" and "highly sensitive" mode. So these three configured modes will not be affected even if the following constants are edited. It is recommended to define -k, -a and -l when the following constants are changed manually:</p>

<ul>
<li>To increase/decrease the seed tuple distance in a cluster change the constant SEED_TUPLE_DIST</li>
<li>To increase/decrease the primary anchor word size change the constant PRIM_ANCHOR_WORD</li>
<li>To increase/decrease the secondary anchor word size change the constant SECND_ANCHOR_WORD</li>
<li>To increase/decrease the primary anchor percent of identity change the constant PRIM_ANCHOR_PIDENT </li>
<li>To increase/decrease the secondary anchor percent of identity change the constant SECND_ANCHOR_PIDENT</li>
<li>To increase/decrease the size of block for banded sequence alignment change the constant FRAGMENT_SIZE</li>
</ul>

<p>Once again, define -k, -a and -l while running the ./nanoblaster executable with these changed constants</p>

<h3>
<a id="contact-information" class="anchor" href="#contact-information" aria-hidden="true"><span class="octicon octicon-link"></span></a>Contact information</h3>

<p>Please send your comments or bug reports to <a href="mailto:moamin@cs.stonybrook.edu">moamin@cs.stonybrook.edu</a> </p>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">NanoBLASTer maintained by <a href="https://github.com/ruhulsbu">ruhulsbu</a></p>
        <p>Published with <a href="https://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

              <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-65164000-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>


  </body>
</html>
